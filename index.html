<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PC Monitor</title>
<style>
body{font-family:Arial;text-align:center;margin-top:50px;background:#111;color:white;}
button{font-size:24px;padding:20px 40px;border-radius:15px;border:none;margin:20px;}
#toggleBtn{width:250px;}
#status{text-align:center;font-size:18px;margin-top:20px;}
</style>
</head>
<body>
<h1>PC Monitor</h1>
<button id="toggleBtn" onclick="toggle()">Loading...</button>
<div id="status"></div>

<script>
const gistId = "pc_monitor.txt";           // replace with Gist ID
const githubToken = "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"; // replace with GitHub token
const rawUrl = "https://gist.githubusercontent.com/masterbonger/fb9897314c8208d3e54c83a4c5d99a11/raw/f0eb842c028229adeb634456d51a606d83fd8a8d/pc_monitor.txt";      // replace with Raw Gist URL

let currentState = "OFF";

async function fetchState(){
    try{
        const res = await fetch(rawUrl);
        const text = await res.text();
        currentState = text.trim();
        updateButton();
    } catch(e){
        document.getElementById("status").innerText = "Error fetching state";
    }
}

function updateButton(){
    const btn = document.getElementById("toggleBtn");
    const status = document.getElementById("status");
    if(currentState==="ON"){
        btn.innerText="Monitoring: ON";
        btn.style.background="green";
        status.innerText="PC monitoring is ACTIVE";
    }else{
        btn.innerText="Monitoring: OFF";
        btn.style.background="red";
        status.innerText="PC monitoring is PAUSED";
    }
}

async function toggle(){
    const newState = currentState==="ON"?"OFF":"ON";
    try{
        await fetch(`https://api.github.com/gists/${gistId}`,{
            method:"PATCH",
            headers:{"Authorization":"token "+githubToken,"Content-Type":"application/json"},
            body:JSON.stringify({files:{"pc_monitor.txt":{content:newState}}})
        });
        currentState=newState;
        updateButton();
        alert("Monitoring set to "+newState);
    }catch(e){
        alert("Error updating state");
    }
}

// Initial fetch + auto-refresh every 5 seconds
fetchState();
setInterval(fetchState,5000);
</script>
</body>
</html>
